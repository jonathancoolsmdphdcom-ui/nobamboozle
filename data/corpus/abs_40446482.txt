Learnable prototype-guided multiple instance learning for detecting tertiary lymphoid structures in multi-cancer whole-slide pathological images.

Tertiary lymphoid structures (TLS) are ectopic lymphoid aggregates that form under specific pathological conditions, such as chronic inflammation and malignancies. Their presence within the tumor microenvironment (TME) is strongly correlated with patient prognosis and response to immunotherapy, making TLS detection in whole-slide pathological images (WSIs) crucial for clinical decision-making. Although multiple instance learning (MIL) has shown promise in tumor microenvironment studies, its potential for TLS detection has received limited attention. Additionally, the sparsity and heterogeneity of TLS in WSIs present significant challenges for feature extraction and limit the generalizability of MIL across different cancer types. To address this issue, this paper proposes a weakly supervised framework, Learnable Prototype-Guided Multiple Instance Learning (LPGMIL). From the perspective of the cellular composition of TLS, LPGMIL selects lymphocyte-dense instances to construct learnable global prototypes that are gradually adjusted during training to focus on TLS-related features. Additionally, LPGMIL computes each WSI using multiple learnable global prototypes, effectively capturing diverse TLS pathological patterns and refining the representation of complex TLS features. Unlike previous methods evaluated on single cancer-type datasets, we integrate a six-cancer-type TCGA dataset to better reflect the diversity and complexity of real-world clinical cases. Experimental results and visualizations show that LPGMIL outperforms other compared methods on a six-cancer-type TCGA dataset, achieving 76.6 % accuracy, 74.1 % recall, 82.7 % F1-score, and 83.5 % AUC, demonstrating its effectiveness in addressing the sparsity and heterogeneity of TLS. Code is available at: https://github.com/FPXMU/LPGMIL.